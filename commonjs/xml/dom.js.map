{"version":3,"file":"dom.js","names":["findChild","node","tagName","i","childNodes","length","childNode","nodeType","getTagName","findChildren","results","push","forEach","func","map","NAMESPACE_REG_EXP","element","replace","getOuterXml","textContent","xml","j","attributes","name","value"],"sources":["../../source/xml/dom.js"],"sourcesContent":["export function findChild(node, tagName) {\n\tlet i = 0\n\twhile (i < node.childNodes.length) {\n\t\tconst childNode = node.childNodes[i]\n\t\t// `nodeType: 1` means \"Element\".\n\t\t// https://www.w3schools.com/xml/prop_element_nodetype.asp\n\t\tif (childNode.nodeType === 1 && getTagName(childNode) === tagName) {\n\t\t\treturn childNode\n\t\t}\n\t\ti++\n\t}\n}\n\nexport function findChildren(node, tagName) {\n\tconst results = []\n\tlet i = 0\n\twhile (i < node.childNodes.length) {\n\t\tconst childNode = node.childNodes[i]\n\t\t// `nodeType: 1` means \"Element\".\n\t\t// https://www.w3schools.com/xml/prop_element_nodetype.asp\n\t\tif (childNode.nodeType === 1 && getTagName(childNode) === tagName) {\n\t\t\tresults.push(childNode)\n\t\t}\n\t\ti++\n\t}\n\treturn results\n}\n\nexport function forEach(node, tagName, func) {\n\t// if (typeof tagName === 'function') {\n\t// \tfunc = tagName\n\t// \ttagName = undefined\n\t// }\n\tlet i = 0\n\twhile (i < node.childNodes.length) {\n\t\tconst childNode = node.childNodes[i]\n\t\tif (tagName) {\n\t\t\t// `nodeType: 1` means \"Element\".\n\t\t\t// https://www.w3schools.com/xml/prop_element_nodetype.asp\n\t\t\tif (childNode.nodeType === 1 && getTagName(childNode) === tagName) {\n\t\t\t\tfunc(childNode, i)\n\t\t\t}\n\t\t} else {\n\t\t\tfunc(childNode, i)\n\t\t}\n\t\ti++\n\t}\n}\n\nexport function map(node, tagName, func) {\n\tconst results = []\n\tforEach(node, tagName, (node, i) => {\n\t\tresults.push(func(node, i))\n\t})\n\treturn results\n}\n\nconst NAMESPACE_REG_EXP = /.+\\:/\nexport function getTagName(element) {\n\t// For some weird reason, if an element is declared as,\n\t// for example, `<x:sheets/>`, then its `.tagName` will be\n\t// \"x:sheets\" instead of just \"sheets\".\n\t// https://gitlab.com/catamphetamine/read-excel-file/-/issues/25\n\t// Its not clear how to tell it to ignore any namespaces\n\t// when getting `.tagName`, so just replacing anything\n\t// before a colon, if any.\n\treturn element.tagName.replace(NAMESPACE_REG_EXP, '')\n}\n\n// This function is only used for occasional debug messages.\nexport function getOuterXml(node) {\n\t// `nodeType: 1` means \"Element\".\n\t// https://www.w3schools.com/xml/prop_element_nodetype.asp\n\tif (node.nodeType !== 1) {\n\t\treturn node.textContent\n\t}\n\n  let xml = '<' + getTagName(node)\n\n  let j = 0\n  while (j < node.attributes.length) {\n    xml += ' ' + node.attributes[j].name + '=' + '\"' + node.attributes[j].value + '\"'\n    j++\n  }\n\n  xml += '>'\n\n  let i = 0\n  while (i < node.childNodes.length) {\n  \txml += getOuterXml(node.childNodes[i])\n    i++\n  }\n\n  xml += '</' + getTagName(node) + '>'\n\n  return xml\n}"],"mappings":"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"}