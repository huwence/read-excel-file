{"version":3,"file":"parseDimensions.js","names":["parseCellCoordinates","getDimensions","parseDimensions","sheet","dimensions","split","map","row","column","length"],"sources":["../../source/read/parseDimensions.js"],"sourcesContent":["import {\n  parseCellCoordinates\n} from './coordinates.js'\n\nimport {\n  getDimensions\n} from '../xml/xlsx.js'\n\n// `dimensions` defines the spreadsheet area containing all non-empty cells.\n// https://docs.microsoft.com/en-us/dotnet/api/documentformat.openxml.spreadsheet.sheetdimension?view=openxml-2.8.1\nexport default function parseDimensions(sheet) {\n  let dimensions = getDimensions(sheet)\n  if (dimensions) {\n    dimensions = dimensions.split(':').map(parseCellCoordinates).map(([row, column]) => ({\n      row,\n      column\n    }))\n    // Sometimes there can be just a single cell as a spreadsheet's \"dimensions\".\n    // For example, the default \"dimensions\" in Apache POI library is \"A1\",\n    // meaning that only the first cell in the spreadsheet is used.\n    //\n    // A quote from Apache POI library:\n    // \"Single cell ranges are formatted like single cell references (e.g. 'A1' instead of 'A1:A1').\"\n    //\n    if (dimensions.length === 1) {\n      dimensions = [dimensions[0], dimensions[0]]\n    }\n    return dimensions\n  }\n}\n\n"],"mappings":";;;;;;AAAA,SACEA,oBAAoB,QACf,kBAAkB;AAEzB,SACEC,aAAa,QACR,gBAAgB;;AAEvB;AACA;AACA,eAAe,SAASC,eAAe,CAACC,KAAK,EAAE;EAC7C,IAAIC,UAAU,GAAGH,aAAa,CAACE,KAAK,CAAC;EACrC,IAAIC,UAAU,EAAE;IACdA,UAAU,GAAGA,UAAU,CAACC,KAAK,CAAC,GAAG,CAAC,CAACC,GAAG,CAACN,oBAAoB,CAAC,CAACM,GAAG,CAAC;MAAA;QAAEC,GAAG;QAAEC,MAAM;MAAA,OAAO;QACnFD,GAAG,EAAHA,GAAG;QACHC,MAAM,EAANA;MACF,CAAC;IAAA,CAAC,CAAC;IACH;IACA;IACA;IACA;IACA;IACA;IACA;IACA,IAAIJ,UAAU,CAACK,MAAM,KAAK,CAAC,EAAE;MAC3BL,UAAU,GAAG,CAACA,UAAU,CAAC,CAAC,CAAC,EAAEA,UAAU,CAAC,CAAC,CAAC,CAAC;IAC7C;IACA,OAAOA,UAAU;EACnB;AACF"}