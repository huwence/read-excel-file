{"version":3,"file":"parseSheet.js","names":["parseCells","parseDimensions","calculateDimensions","parseCellCoordinates","getMergedCells","parseSheet","content","xml","values","styles","properties","options","sheet","createDocument","cells","mergedCells","mergedCell","split","map","from","to","push","dimensions"],"sources":["../../source/read/parseSheet.js"],"sourcesContent":["import parseCells from './parseCells.js'\nimport parseDimensions from './parseDimensions.js'\n\nimport { calculateDimensions, parseCellCoordinates } from './coordinates.js'\nimport { getMergedCells } from '../xml/xlsx.js'\n\nexport default function parseSheet(content, xml, values, styles, properties, options) {\n  const sheet = xml.createDocument(content)\n\n  const cells = parseCells(sheet, xml, values, styles, properties, options)\n\n  const mergedCells = []\n  // const mergedCells = getMergedCells(sheet)\n  for (const mergedCell of getMergedCells(sheet)) {\n    const [from, to] = mergedCell.split(':').map(parseCellCoordinates)\n    // console.log('Merged Cell.', 'From:', from, 'To:', to)\n    mergedCells.push({ from, to })\n  }\n\n  // `dimensions` defines the spreadsheet area containing all non-empty cells.\n  // https://docs.microsoft.com/en-us/dotnet/api/documentformat.openxml.spreadsheet.sheetdimension?view=openxml-2.8.1\n  const dimensions = parseDimensions(sheet) || calculateDimensions(cells)\n\n  return { cells, dimensions, mergedCells }\n}"],"mappings":";;;;;;;AAAA,OAAOA,UAAU,MAAM,iBAAiB;AACxC,OAAOC,eAAe,MAAM,sBAAsB;AAElD,SAASC,mBAAmB,EAAEC,oBAAoB,QAAQ,kBAAkB;AAC5E,SAASC,cAAc,QAAQ,gBAAgB;AAE/C,eAAe,SAASC,UAAU,CAACC,OAAO,EAAEC,GAAG,EAAEC,MAAM,EAAEC,MAAM,EAAEC,UAAU,EAAEC,OAAO,EAAE;EACpF,IAAMC,KAAK,GAAGL,GAAG,CAACM,cAAc,CAACP,OAAO,CAAC;EAEzC,IAAMQ,KAAK,GAAGd,UAAU,CAACY,KAAK,EAAEL,GAAG,EAAEC,MAAM,EAAEC,MAAM,EAAEC,UAAU,EAAEC,OAAO,CAAC;EAEzE,IAAMI,WAAW,GAAG,EAAE;EACtB;EACA,qDAAyBX,cAAc,CAACQ,KAAK,CAAC,wCAAE;IAAA,IAArCI,UAAU;IACnB,4BAAmBA,UAAU,CAACC,KAAK,CAAC,GAAG,CAAC,CAACC,GAAG,CAACf,oBAAoB,CAAC;MAAA;MAA3DgB,IAAI;MAAEC,EAAE;IACf;IACAL,WAAW,CAACM,IAAI,CAAC;MAAEF,IAAI,EAAJA,IAAI;MAAEC,EAAE,EAAFA;IAAG,CAAC,CAAC;EAChC;;EAEA;EACA;EACA,IAAME,UAAU,GAAGrB,eAAe,CAACW,KAAK,CAAC,IAAIV,mBAAmB,CAACY,KAAK,CAAC;EAEvE,OAAO;IAAEA,KAAK,EAALA,KAAK;IAAEQ,UAAU,EAAVA,UAAU;IAAEP,WAAW,EAAXA;EAAY,CAAC;AAC3C"}