{"version":3,"file":"unpackXlsxFileBrowser.js","names":["unzipSync","strFromU8","unpackXlsxFile","input","File","arrayBuffer","then","unpackXlsxArrayBuffer","Blob","archive","Uint8Array","contents","Promise","resolve","getContents","unzippedFiles","Object","keys","key"],"sources":["../../source/read/unpackXlsxFileBrowser.js"],"sourcesContent":["import { unzipSync, strFromU8 } from 'fflate'\n\n/**\n * Reads XLSX file in a browser.\n * @param  {(File|Blob|ArrayBuffer)} input - A `File` or an `ArrayBuffer`.\n * @return {Promise} Resolves to an object holding XLSX file entries.\n */\nexport default function unpackXlsxFile(input) {\n\tif (input instanceof File) {\n\t\treturn input.arrayBuffer().then(unpackXlsxArrayBuffer)\n\t}\n\tif (input instanceof Blob) {\n\t\treturn input.arrayBuffer().then(unpackXlsxArrayBuffer)\n\t}\n\treturn unpackXlsxArrayBuffer(input)\n}\n\n/**\n * Reads XLSX file in a browser from an `ArrayBuffer`.\n * @param  {ArrayBuffer} input\n * @return {Promise} Resolves to an object holding XLSX file entries.\n */\nfunction unpackXlsxArrayBuffer(arrayBuffer) {\n\tconst archive = new Uint8Array(arrayBuffer)\n\tconst contents = unzipSync(archive)\n\treturn Promise.resolve(getContents(contents))\n\t// return new Promise((resolve, reject) => {\n\t// \tunzip(archive, (error, contents) => {\n\t// \t\tif (error) {\n\t// \t\t\treturn reject(error)\n\t// \t\t}\n\t// \t\treturn resolve(getContents(contents))\n\t// \t})\n\t// })\n}\n\nfunction getContents(contents) {\n\tconst unzippedFiles = []\n\tfor (const key of Object.keys(contents)) {\n\t\tunzippedFiles[key] = strFromU8(contents[key])\n\t}\n\treturn unzippedFiles\n}"],"mappings":"AAAA,SAASA,SAAS,EAAEC,SAAS,QAAQ,QAAQ;;AAE7C;AACA;AACA;AACA;AACA;AACA,eAAe,SAASC,cAAc,CAACC,KAAK,EAAE;EAC7C,IAAIA,KAAK,YAAYC,IAAI,EAAE;IAC1B,OAAOD,KAAK,CAACE,WAAW,EAAE,CAACC,IAAI,CAACC,qBAAqB,CAAC;EACvD;EACA,IAAIJ,KAAK,YAAYK,IAAI,EAAE;IAC1B,OAAOL,KAAK,CAACE,WAAW,EAAE,CAACC,IAAI,CAACC,qBAAqB,CAAC;EACvD;EACA,OAAOA,qBAAqB,CAACJ,KAAK,CAAC;AACpC;;AAEA;AACA;AACA;AACA;AACA;AACA,SAASI,qBAAqB,CAACF,WAAW,EAAE;EAC3C,IAAMI,OAAO,GAAG,IAAIC,UAAU,CAACL,WAAW,CAAC;EAC3C,IAAMM,QAAQ,GAAGX,SAAS,CAACS,OAAO,CAAC;EACnC,OAAOG,OAAO,CAACC,OAAO,CAACC,WAAW,CAACH,QAAQ,CAAC,CAAC;EAC7C;EACA;EACA;EACA;EACA;EACA;EACA;EACA;AACD;;AAEA,SAASG,WAAW,CAACH,QAAQ,EAAE;EAC9B,IAAMI,aAAa,GAAG,EAAE;EACxB,gCAAkBC,MAAM,CAACC,IAAI,CAACN,QAAQ,CAAC,kCAAE;IAApC,IAAMO,GAAG;IACbH,aAAa,CAACG,GAAG,CAAC,GAAGjB,SAAS,CAACU,QAAQ,CAACO,GAAG,CAAC,CAAC;EAC9C;EACA,OAAOH,aAAa;AACrB"}