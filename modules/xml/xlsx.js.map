{"version":3,"file":"xlsx.js","names":["findChild","findChildren","forEach","map","getTagName","getCells","document","worksheet","documentElement","sheetData","cells","row","cell","push","getMergedCells","mergedCells","mergedCellsInfo","mergedCell","getAttribute","getCellValue","node","getCellInlineStringValue","firstChild","textContent","getDimensions","dimensions","getBaseStyles","styleSheet","cellStyleXfs","getCellStyles","cellXfs","getNumberFormats","numberFormats","numFmts","getSharedStrings","sst","string","t","value","r","getWorkbookProperties","workbook","getRelationships","relationships","getSheets","sheets"],"sources":["../../source/xml/xlsx.js"],"sourcesContent":["import { findChild, findChildren, forEach, map, getTagName } from './dom.js'\n\nexport function getCells(document) {\n  const worksheet = document.documentElement\n  const sheetData = findChild(worksheet, 'sheetData')\n\n  const cells = []\n  forEach(sheetData, 'row', (row) => {\n    forEach(row, 'c', (cell) => {\n      cells.push(cell)\n    })\n  })\n  return cells\n}\n\nexport function getMergedCells(document) {\n  const worksheet = document.documentElement\n  const mergedCells = findChild(worksheet, 'mergeCells')\n  const mergedCellsInfo = []\n  if (mergedCells) {\n    forEach(mergedCells, 'mergeCell', (mergedCell) => {\n      mergedCellsInfo.push(mergedCell.getAttribute('ref'))\n    })\n  }\n  return mergedCellsInfo\n}\n\nexport function getCellValue(document, node) {\n  return findChild(node, 'v')\n}\n\nexport function getCellInlineStringValue(document, node) {\n  if (\n    node.firstChild &&\n    getTagName(node.firstChild) === 'is' &&\n    node.firstChild.firstChild &&\n    getTagName(node.firstChild.firstChild) === 't'\n  ) {\n    return node.firstChild.firstChild.textContent\n  }\n}\n\nexport function getDimensions(document) {\n  const worksheet = document.documentElement\n  const dimensions = findChild(worksheet, 'dimension')\n  if (dimensions) {\n    return dimensions.getAttribute('ref')\n  }\n}\n\nexport function getBaseStyles(document) {\n  const styleSheet = document.documentElement\n  const cellStyleXfs = findChild(styleSheet, 'cellStyleXfs')\n  if (cellStyleXfs) {\n    return findChildren(cellStyleXfs, 'xf')\n  }\n  return []\n}\n\nexport function getCellStyles(document) {\n  const styleSheet = document.documentElement\n  const cellXfs = findChild(styleSheet, 'cellXfs')\n  if (!cellXfs) {\n    return []\n  }\n  return findChildren(cellXfs, 'xf')\n}\n\nexport function getNumberFormats(document) {\n  const styleSheet = document.documentElement\n  let numberFormats = []\n  const numFmts = findChild(styleSheet, 'numFmts')\n  if (numFmts) {\n    return findChildren(numFmts, 'numFmt')\n  }\n  return []\n}\n\nexport function getSharedStrings(document) {\n\t// An `<si/>` element can contain a `<t/>` (simplest case) or a set of `<r/>` (\"rich formatting\") elements having `<t/>`.\n\t// https://docs.microsoft.com/en-us/dotnet/api/documentformat.openxml.spreadsheet.sharedstringitem?redirectedfrom=MSDN&view=openxml-2.8.1\n\t// http://www.datypic.com/sc/ooxml/e-ssml_si-1.html\n\n  const sst = document.documentElement\n  return map(sst, 'si', string => {\n    const t = findChild(string, 't')\n    if (t) {\n      return t.textContent\n    }\n    let value = ''\n    forEach(string, 'r', (r) => {\n      value += findChild(r, 't').textContent\n    })\n    return value\n  })\n}\n\nexport function getWorkbookProperties(document) {\n  const workbook = document.documentElement\n  return findChild(workbook, 'workbookPr')\n}\n\nexport function getRelationships(document) {\n  const relationships = document.documentElement\n  return findChildren(relationships, 'Relationship')\n}\n\nexport function getSheets(document) {\n  const workbook = document.documentElement\n  const sheets = findChild(workbook, 'sheets')\n  return findChildren(sheets, 'sheet')\n}"],"mappings":"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"}